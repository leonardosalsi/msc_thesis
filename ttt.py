import json
import os

from Bio import SeqIO
from tqdm import tqdm

SIM_SC = 95
SRC_DIR = f'/cluster/work/grlab/projects/projects2024-petagraph-input-optimisation-msc-thesis/generated_datasets/logan_filtered_{SIM_SC}'

if __name__ == '__main__':
    file_list = [405, 458, 236, 341, 37, 63, 150, 14, 417, 304, 66, 17, 269, 498, 161, 434, 162, 181, 238, 291, 332, 245, 241, 112, 229, 149, 449, 399, 0, 224, 320, 396, 468, 496, 438, 300, 54, 21, 428, 463, 171, 223, 31, 362, 168, 427, 485, 414, 148, 132, 207, 35, 488, 425, 368, 261, 254, 33, 197, 7, 258, 433, 423, 127, 213, 68, 436, 426, 80, 464, 478, 267, 8, 43, 217, 134, 29, 210, 142, 235, 270, 57, 177, 237, 456, 205, 473, 188, 147, 471, 70, 71, 360, 105, 418, 25, 354, 136, 53, 313, 3, 383, 84, 268, 222, 483, 117, 279, 110, 275, 371, 424, 407, 156, 459, 11, 173, 404, 118, 79, 62, 45, 288, 58, 69, 259, 13, 265, 348, 403, 129, 214, 233, 77, 398, 435, 16, 280, 430, 303, 369, 76, 144, 26, 401, 402, 49, 474, 12, 78, 151, 364, 287, 180, 128, 391, 141, 242, 375, 382, 319, 28, 367, 225, 302, 378, 440, 208, 104, 477, 263, 83, 89, 249, 209, 257, 123, 470, 272, 64, 6, 493, 453, 489, 252, 373, 73, 9, 328, 87, 20, 491, 361, 167, 81, 248, 495, 42, 330, 255, 189, 441, 145, 122, 137, 311, 221, 333, 285, 193, 462, 133, 326, 457, 126, 490, 152, 113, 198, 476, 116, 282, 92, 494, 96, 413, 56, 199, 99, 379, 47, 139, 24, 351, 429, 115, 292, 218, 454, 251, 231, 447, 200, 253, 469, 262, 111, 408]
    total = 0
    for idx in tqdm(file_list):
        path = os.path.join(SRC_DIR, f'random_walk_{idx}.fasta')
        if not os.path.isfile(path):
            print(f"⚠️ Missing file: {path}")
            continue

        # count sequences in this file
        n = sum(1 for _ in SeqIO.parse(path, "fasta"))
        #print(f"{os.path.basename(path)}: {n}")
        total += n
    print(f"\n➡️ {SIM_SC} -- Total sequences across all FASTAs: {total}")